---
title: "Analysis"
author: "Group D"
date: "4/22/2019"
output: pdf_document
---


```{r}
library(randomForest) # for random forests and bagging
```

# Preliminary Analysis

The last column of the dataset (20533) is named "Class" - this is what we are trying to find

Columns 2:20532 are genes

```{r}
head(groupddata)
unique(groupddata$Class)
```


*** This takes about 10 minutes to run! ***

Working through the dataset to reduce the number of predictors that we are going to use for further analyses.

```{r, cache = TRUE}
pvals <- rep(1, 20530)

for(i in 1:20530){
  if(i %% 5000 == 0){
    print(i)
  }
  s <- i + 1
  pvals[i] <- anova(lm(groupddata[, s] ~ Class, data = groupddata))$"Pr(>F)"[1]
} #find all ANOVA p-values

#adjust for multiple testing
holmp <- p.adjust(pvals, method = "bonf")
length(which(holmp == 0))

#which ones are < 0.05 (for example)
myvars <- which(holmp == 0) + 1 #add one because MouseNum is at the start and was skipped

reducedGroupData <- data.frame(groupddata[, c(myvars, 20533)])
reducedGroupData$Class <- as.factor(reducedGroupData$Class)

# ggplot(reducedGroupData) + geom_density(aes(x = gene_7421, color = Class))
# ggplot(reducedGroupData) + geom_density(aes(x = gene_203, color = Class))
# ggplot(reducedGroupData) + geom_density(aes(x = gene_5829, color = Class))
# ggplot(reducedGroupData) + geom_density(aes(x = gene_16259, color = Class))

```





```{r}
set.seed(40)
cancerRandomForest <- randomForest(Class ~ ., data = reducedGroupData, mtry = 10, ntree = 100, importance = T, proximity = T)
cancerRandomForest
table(reducedGroupData$Class, predict(cancerRandomForest, groupddata))
```











